"draw_new_grid = function(grid,g,xscale,yscale,redraw) {\n  \n    var thisgrid = g.selectAll('image');\n    var w = Math.abs(xscale(grid.info.resolution*grid.info.width_cells) - xscale(0));\n    var h = Math.abs(yscale(grid.info.resolution*grid.info.height_cells) - yscale(0));\n    var res = grid.info.resolution;\n    var x0 = grid.info.origin.x;\n    var y0 = grid.info.origin.y;\n    if (thisgrid.size() === 0 || redraw) {\n      thisgrid.remove();\n      thisgrid = g.append('image').attr('xlink:href',\"data:image/png;base64, \"+grid.data)\n        .attr('opacity',0.3);\n    }\n    thisgrid.attr('x',xscale(x0)).attr('y',yscale(y0)-h).attr('height',h).attr('width',w);\n    \n    /*if (thisgrid.size() !== grid.data.length) {\n      thisgrid.remove().data(grid.data)\n        .enter().append('rect').attr('width',w).attr('height',h)\n        .attr('x', function (d,i) { return xscale(x0 + res*(i % grid_width)); })\n        .attr('y', function (d,i) { return yscale(y0 + res*Math.floor(i/grid_width)); })\n        .style('fill',function(d,i) {\n          return (d>0) ? 'red' : 'white';\n        })\n        .style('opacity',0.3);\n    }*/\n\n}"